#!/bin/sh

if [ "x$NOTCLX" = "x" ]; then
    TCLX=""
else
    TCLX="-tclx"
fi

if [ "x$NOTCLUDP" = "x" ]; then
    TCLUDP="-tcludp"
else
    TCLUDP=""
fi

if [ "x$THREADEDX11" = "x" ]; then
    TX="-no-threadedx11"
else
    TX="-threadedx11"
fi

if [ "x$HASMYSQLTCL" = "x" ]; then
    MYSQLTCL=""
else
    MYSQLTCL="-mysqltcl"
fi

if [ "x$NOPGTCL" = "x" ]; then
    PGTCL="-pgtcl"
else
    PGTCL=""
fi

# threaded
tclsh gen/buildkit build -tcl -itcl -thread -sqlite3 -tclcompiler -tbcload -tls $TCLX -tk -tile -itk -iwidgets -blt -tk -tiletable -tdom -tk -tiletreectrl $TCLUDP $MYSQLTCL $PGTCL -binary=all -resfile=current || exit 1
tclsh gen/buildkit linkfinal -tcl -tk -tile -thread -sqlite3 -tbcload -tls $TCLX -binary=gui -resfile=current || exit 1
tclsh gen/buildkit compile res -thread -resfile=current || exit 1
tclsh gen/buildkit linkfinal -tcl -itcl -thread -sqlite3 -tclcompiler -tbcload -tls $TCLX -tdom -binary=console -resfile=current || exit 1
tclsh gen/buildkit linkfinal -tcl -thread -binary=tiny -resfile=current || exit 1

# nonthreaded
tclsh gen/buildkit build -tcl -itcl -sqlite3 -tclcompiler -tbcload -tls $TCLX -tk -tile -itk -iwidgets -blt -tk -tiletable -tdom -tk -tiletreectrl $TCLUDP $MYSQLTCL $PGTCL $TX -binary=all -resfile=current || exit 1
tclsh gen/buildkit linkfinal -tcl -tk -tile -sqlite3 -tbcload -tls $TCLX -binary=gui $TX -resfile=current || exit 1
tclsh gen/buildkit compile res -resfile=current || exit 1
tclsh gen/buildkit linkfinal -tcl -itcl -sqlite3 -tclcompiler -tbcload -tls $TCLX -tdom $TCLUDP $PGTCL -binary=console -resfile=current || exit 1
tclsh gen/buildkit linkfinal -tcl -binary=tiny -resfile=current || exit 1

# threaded debug
#tclsh gen/buildkit compile res -thread -debug -resfile=current || exit 1
#tclsh gen/buildkit build -debug -tcl -itcl -thread -sqlite3 -tbcload -tls $TCLX -tk -tile -itk -iwidgets -blt -tk -tiletable -tdom -tk -tiletreectrl $TCLUDP $PGTCL -binary=all -resfile=current || exit 1

